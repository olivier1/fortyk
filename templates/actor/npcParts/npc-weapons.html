<section class="tab sheet-content {{tabs.weapons.id}} {{tabs.weapons.cssClass}}"
         data-tab="{{tabs.weapons.id}}"
         data-group="{{tabs.weapons.group}}">

    <div class="flexrow">
        <a class="item-create button" data-type="rangedWeapon" title="Add a Ranged Weapon">Add ranged weapon</a>
        <a class="item-create button" data-type="meleeWeapon" title="Add a Melee Weapon">Add melee weapon</a>
    </div>
    <div class="grid grid-2col item-list no-place">
        {{#each actor.weapons}}
        {{#if (contains this.type "melee")}}
        <div>
            <div class="weapons grid grid-2col">
                <div class="weapon-name item draggable" data-item-id="{{this.id}}" data-uuid="{{this.uuid}}" data-type="{{this.type}}" draggable="true">
                    {{#if flags.fortyk.alternateprofiles}}

                    <select class="profile-select" data-id="{{this.id}}">
                        <option value="">{{this._source.name}}</option>
                        {{selectOptions flags.fortyk.instancedProfiles selected=flags.fortyk.currentprofile valueAttr="uuid" labelAttr="name"}}

                    </select>
                    {{else}}

                    <span>{{this.name}}</span>

                    {{/if}}
                </div>


                <div class="list-item">
                    <span>Attack: </span>
                    <span class="melee-attack rollable button" data-roll-type="meleeAttack" data-target="{{../system.characteristics.ws.total}}" data-item-id="{{this._id}}" data-label="Melee Attack" data-char="ws">Roll</span>
                </div>
                <div class="list-item">
                    <span>Damage: </span>
                    <a class="damage-roll button" data-label="{{this.name}}" data-formula="{{this.system.damageFormula.value}}" data-weapon="{{this._id}}"> {{this.system.damageFormula.value}}</a>
                </div>
                {{#if this.flags.fortyk.force}}
                <div class="list-item">

                    <a class="force-roll button" data-label="Force"> Force</a>


                </div>
                {{/if}}
                <div class="list-item">
                    <span>Reach: {{this.system.range.value}}m</span>
                </div>
                <div class="list-item">
                    <span>Penetration: {{this.system.pen.value}}</span>

                </div>
                {{#if this.system.specialFlags.length}}
                <div class="list-item">
                    <span>Special:
                        {{#each this.system.specialFlags }}
                        <a class="item-descr" data-name="{{label}}" data-item-descr="{{description}}">{{label}}</a>
                        {{/each}}
                    </span>
                </div>
                {{/if}}
                <div class="list-item">
                    <span>Damage Type: {{this.system.damageType.value}}</span>

                </div>
                <div class="list-item">
                    <span>Weapon Class: {{this.system.class.value}}</span>


                </div>
                <div class="list-item">
                    <span>Weapon Type: {{this.system.type.value}}</span>


                </div>
                <div class="list-item flexrow">
                    <a class="list-button item-edit" title="Edit" data-item-id="{{this._id}}"></a>
                    <a class="list-button item-delete" title="Delete" data-item-id="{{this._id}}"></a>
                </div>
            </div>
        </div>
        {{else}}
        <div>

            <div class="weapons grid grid-2col">
                <div class="weapon-name item draggable" data-item-id="{{this.id}}" data-uuid="{{this.uuid}}" data-type="{{this.type}}" draggable="true">
                    {{#if flags.fortyk.alternateprofiles}}

                    <select class="profile-select" data-id="{{this.id}}">
                        <option value="">{{this._source.name}}</option>
                        {{selectOptions flags.fortyk.instancedProfiles selected=flags.fortyk.currentprofile valueAttr="uuid" labelAttr="name"}}

                    </select>
                    {{else}}

                    <span>{{this.name}}</span>

                    {{/if}}
                </div>


                <div class="list-item">
                    <span>Attack: </span>
                    {{#if this.flags.fortyk.spray}}
                    <span class="spray-attack rollable button" data-roll-type="sprayAttack" data-item-id="{{this.id}}" data-label="Spray Attack" >Spray</span>
                    {{else if this.flags.fortyk.torrent}}
                    <span class="torrent-attack rollable button" data-roll-type="torrentAttack" data-item-id="{{this.id}}" data-label="Torrent Attack" >Torrent</span>
                    {{else}}

                    <span class="ranged-attack rollable button" data-roll-type="rangedAttack" data-target="{{../system.characteristics.bs.total}}" data-item-id="{{this.id}}" data-label="Ranged Attack" data-char="bs">Roll</span>

                    {{/if}}

                </div>
                <div class="list-item">
                    <span>Damage: </span>
                    <a class="damage-roll button" data-label="{{this.name}}"data-formula="{{this.system.damageFormula.value}}" data-weapon="{{this._id}}"> {{this.system.damageFormula.value}}</a>

                </div>

                {{#if this.flags.fortyk.force}}
                <div class="list-item">

                    <a class="force-roll button" data-label="Force"> Force</a>


                </div>
                {{/if}}
                {{#if this.flags.fortyk.maximal}}
                <div class="list-item">
                    <span>Maximal: <input type="checkbox" class="maximal" data-item-id="{{this._id}}"  {{checked this.flags.fortyk.maximalMode}}></span>


                </div>
                {{/if}}
                {{#if this.flags.fortyk.lasModal}}
                <div class="list-item">
                    <span>Las Fire Mode:
                        <select class="lasMode"  data-item-id="{{this._id}}" data-dtype="Number">
                            {{selectOptions this.FORTYK.lasModes selected=this.flags.fortyk.lasMode valueAttr="key" labelAttr="label"}}

                        </select>
                    </span>


                </div>
                {{/if}}
                <div class="list-item flexrow">
                    <span>Clip: </span>

                    <input class="item-text-input" type="number" data-target="system.clip.value" value="{{this.system.clip.value}}" name="this.system.clip.value" data-item-id="{{this._id}}" data-dtype="Number">
                    <span> / </span>
                    <span>{{this.system.clip.max}}</span>

                </div>
                <div class="list-item">
                    <span>Range: {{this.system.range.value}}m</span>
                </div>
                <div class="list-item">
                    <span>Penetration: {{this.system.pen.value}}</span>

                </div>
                <div class="list-item">
                    <label>Rate of Fire: {{this.system.rof.[0].value}}/{{this.system.rof.[1].value}}/{{this.system.rof.[2].value}}</label>
                </div>
                <div class="list-item">
                    <span>Reload: {{this.system.reload.value}}</span>

                </div>
                {{#if this.system.specialFlags.length}}
                <div class="list-item">
                    <span>Special:
                        {{#each this.system.specialFlags }}
                        <a class="item-descr" data-name="{{label}}" data-item-descr="{{description}}">{{label}}</a>
                        {{/each}}
                    </span>
                </div>
                {{/if}}
                <div class="list-item">
                    <span>Damage Type: {{this.system.damageType.value}}</span>

                </div>
                <div class="list-item">
                    <span>Weapon Class: {{this.system.class.value}}</span>


                </div>
                <div class="list-item">
                    <span>Weapon Type: {{this.system.type.value}}</span>


                </div>
                <div class="list-item flexrow">

                    <a class="list-button item-edit" title="Edit" data-item-id="{{this._id}}"></a>
                    <a class="list-button item-delete" title="Delete" data-item-id="{{this._id}}"></a>

                </div>

            </div>
        </div>
        {{/if}}
        {{/each}}
    </div>
</section>
